<script>
    let demandChart = null;
    
    function generateDemandCurve() {
        // Obtener valores del formulario
        const quantities = [
            parseInt(document.getElementById("price1").value) || 0,
            parseInt(document.getElementById("price2").value) || 0,
            parseInt(document.getElementById("price3").value) || 0,
            parseInt(document.getElementById("price4").value) || 0,
            parseInt(document.getElementById("price5").value) || 0,
            parseInt(document.getElementById("price6").value) || 0,
            parseInt(document.getElementById("price7").value) || 0
        ];
        
        const prices = [0, 250, 500, 750, 1000, 1250, 1500];
        
        // Mostrar resultados
        document.getElementById("results").style.display = "block";
        
        // Crear tabla de datos
        let tableHtml = `
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Cantidad demandada (latas/mes)</th>
                        <th>Precio (pesos)</th>
                    </tr>
                </thead>
                <tbody>
        `;
        
        for (let i = 0; i < prices.length; i++) {
            tableHtml += `
                <tr>
                    <td>${quantities[i]}</td>
                    <td>$${prices[i]}</td>
                </tr>
            `;
        }
        
        tableHtml += `
                </tbody>
            </table>
        `;
        
        document.getElementById("dataTable").innerHTML = tableHtml;
        
        // Crear el gráfico de demanda
        const ctx = document.getElementById('demandChart').getContext('2d');
        
        // Destruir el gráfico anterior si existe
        if (demandChart) {
            demandChart.destroy();
        }
        
        demandChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: quantities, // Eje X: Cantidad demandada
                datasets: [{
                    label: 'Precio (pesos)',
                    data: prices, // Eje Y: Precio por lata
                    backgroundColor: 'rgba(230, 26, 39, 0.2)',
                    borderColor: 'rgba(230, 26, 39, 1)',
                    borderWidth: 3,
                    pointBackgroundColor: 'rgba(230, 26, 39, 1)',
                    pointRadius: 6,
                    tension: 0.1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                aspectRatio: 1,
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Cantidad demandada (latas/mes)',
                            font: {
                                size: 14,
                                weight: 'bold'
                            }
                        },
                        ticks: {
                            font: {
                                size: 12
                            }
                        }
                    },
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Precio por lata (pesos)',
                            font: {
                                size: 14,
                                weight: 'bold'
                            }
                        },
                        ticks: {
                            font: {
                                size: 12
                            }
                        }
                    }
                },
                plugins: {
                    title: {
                        display: true,
                        text: 'Curva de Demanda de Coca-Cola',
                        font: {
                            size: 18,
                            weight: 'bold'
                        }
                    },
                    legend: {
                        display: true,
                        position: 'top'
                    }
                }
            }
        });
    }
</script>
